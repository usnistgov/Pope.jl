using Pope

searchrange = 385:411
peakval = 9163
ptm = 2651.1770833333335
frametime = 4.8e-6
pulserecord = UInt16[0x12ff,0x129e,0x127f,0x1240,0x1236,0x11c6,0x11b1,0x1152,0x1134,0x10ed,0x10e0,0x10c5,0x10ad,0x1034,0x1018,0x0fe9,0x0fc6,0x0f6f,0x0f6e,0x0f5d,0x0f56,0x0ef1,0x0ee7,0x0e86,0x0e4c,0x0e32,0x0e66,0x0e17,0x0e11,0x0ddf,0x0dba,0x0d82,0x0d94,0x0d82,0x0d73,0x0d3f,0x0d49,0x0cfc,0x0ce8,0x0cab,0x0cce,0x0ca9,0x0ca4,0x0c81,0x0c92,0x0c45,0x0c3c,0x0c37,0x0c40,0x0c10,0x0c06,0x0bec,0x0be6,0x0bb7,0x0be0,0x0bc4,0x0bd6,0x0ba5,0x0b97,0x0b6e,0x0b70,0x0b68,0x0b7b,0x0b52,0x0b57,0x0b2e,0x0b34,0x0b00,0x0b08,0x0b02,0x0b25,0x0af4,0x0b04,0x0ae8,0x0af6,0x0ad7,0x0ad3,0x0aa5,0x0aca,0x0ab5,0x0acd,0x0abb,0x0aa9,0x0a7d,0x0a92,0x0a78,0x0a8c,0x0a87,0x0aa8,0x0a5d,0x0a5a,0x0a3d,0x0a5c,0x0a53,0x0a61,0x0a55,0x0a5c,0x0a50,0x0a4d,0x0a16,0x0a33,0x0a24,0x0a3a,0x0a37,0x0a53,0x0a1f,0x0a13,0x0a0f,0x0a32,0x0a07,0x0a1a,0x0a14,0x0a3d,0x09da,0x09ee,0x09fa,0x09df,0x0a0c,0x0a23,0x0a05,0x09f1,0x09d1,0x09f3,0x09e3,0x0a0e,0x0a13,0x0a13,0x09e1,0x09e6,0x09cd,0x09e5,0x09f9,0x0a05,0x09de,0x09d9,0x09d2,0x09d7,0x09d3,0x09ef,0x09ea,0x09f0,0x09df,0x09d1,0x09b1,0x09b7,0x09bb,0x09d5,0x09d0,0x09d3,0x09bf,0x09bb,0x09b6,0x09cc,0x09b6,0x09b7,0x09ba,0x09c2,0x099c,0x09ab,0x098b,0x099f,0x09a3,0x09b6,0x09ba,0x09be,0x098f,0x098f,0x098f,0x09c7,0x09ae,0x09ad,0x09af,0x09ad,0x0977,0x0979,0x099b,0x09b9,0x0983,0x098f,0x0996,0x099a,0x0981,0x098d,0x09b1,0x09a8,0x0999,0x09ac,0x098e,0x098e,0x098b,0x09a5,0x098e,0x0991,0x0983,0x098e,0x0970,0x0981,0x0983,0x098b,0x0981,0x0997,0x098a,0x098b,0x0969,0x0960,0x0982,0x0985,0x0976,0x099b,0x098e,0x098d,0x0983,0x0988,0x0965,0x0976,0x096f,0x0980,0x0965,0x0971,0x097b,0x0976,0x095e,0x096b,0x0984,0x0991,0x096c,0x0971,0x0946,0x0957,0x0965,0x0987,0x0986,0x0984,0x0962,0x0979,0x0959,0x095f,0x0954,0x097c,0x096d,0x0980,0x0962,0x095c,0x0955,0x0966,0x0980,0x0970,0x0957,0x0954,0x0955,0x0955,0x0943,0x0977,0x0952,0x0950,0x0935,0x0945,0x0949,0x0950,0x094d,0x0962,0x0947,0x0951,0x0929,0x093c,0x0936,0x0952,0x097e,0x0993,0x0949,0x0948,0x0954,0x094a,0x092a,0x095a,0x0957,0x096b,0x091d,0x0934,0x092e,0x093a,0x0954,0x0963,0x094b,0x0954,0x0937,0x094e,0x0934,0x095a,0x0967,0x0964,0x0927,0x0937,0x0929,0x0932,0x0927,0x0939,0x094d,0x0958,0x0931,0x0943,0x093a,0x0948,0x0924,0x0939,0x0954,0x0955,0x092f,0x093f,0x090f,0x091d,0x091b,0x094a,0x0921,0x0945,0x0951,0x0944,0x0921,0x0931,0x092c,0x0937,0x0927,0x0954,0x0914,0x091f,0x090d,0x0927,0x0904,0x0937,0x092f,0x093c,0x0911,0x093a,0x092a,0x0932,0x091f,0x093f,0x0919,0x0937,0x0918,0x091d,0x0909,0x0933,0x0918,0x0935,0x0927,0x093c,0x0912,0x0922,0x0930,0x0950,0x0947,0x095b,0x0930,0x092f,0x0937,0x093c,0x0927,0x0931,0x0937,0x095c,0x0939,0x0942,0x093d,0x0931,0x0923,0x0932,0x0933,0x0955,0x0933,0x0942,0x091d,0x0918,0x0913,0x0929,0x0960,0x0957,0x0915,0x0922,0x0915,0x0913,0x090f,0x0946,0x092b,0x093b,0x0919,0x093a,0x0b44,0x0de3,0x1086,0x12f0,0x152b,0x1736,0x190e,0x1a93,0x1be8,0x1d31,0x1e54,0x1f59,0x201f,0x20e5,0x215f,0x21f5,0x223f,0x22ca,0x2319,0x2375,0x2376,0x23ad,0x23b1,0x23cb,0x23a9,0x23c4,0x23b7,0x23cb,0x239c,0x2377,0x2315,0x22f1,0x22d9,0x22df,0x226a,0x2246,0x21d4,0x21a9,0x2132,0x2120,0x20e1,0x20a5,0x2038,0x1fea,0x1f76,0x1f49,0x1ecb,0x1eb1,0x1e4f,0x1e18,0x1d88,0x1d48,0x1cc6,0x1c83,0x1c3e,0x1c04,0x1b8d,0x1b53,0x1af1,0x1aab,0x1a12,0x19db,0x1973,0x194a,0x18f7,0x18bf,0x1850,0x1816,0x1789,0x175d,0x16f5,0x16d4,0x167e,0x1656,0x15f2,0x1599,0x152d,0x1519,0x14ef,0x14b8,0x144d,0x1430,0x13b2,0x1375,0x131f,0x1313,0x12d4,0x12ad,0x123e,0x1205,0x11db,0x11b5,0x1181,0x1174,0x1120,0x10ff,0x10b9,0x1098,0x1037,0x1020,0x0ff4,0x0fea,0x0f9b,0x0f99,0x0f66,0x0f27,0x0edb,0x0ecf,0x0e8c,0x0e8b,0x0e62,0x0e61,0x0e26,0x0e0f,0x0dd3,0x0dd1,0x0d96,0x0d9b,0x0d78,0x0d79,0x0d16,0x0d13,0x0cf1,0x0cfe,0x0cbf,0x0ccf,0x0cbc,0x0cb0,0x0c6a,0x0c74,0x0c44,0x0c36,0x0c12,0x0c2a,0x0c20,0x0c19,0x0be2,0x0bee,0x0ba6,0x0ba9,0x0bab,0x0bac,0x0b89,0x0b91,0x0b6a,0x0b6d,0x0b49,0x0b51,0x0b6a,0x0b7f,0x0b42,0x0b42,0x0b09,0x0b09,0x0ae9,0x0b01,0x0af9,0x0af5,0x0ae4,0x0b05,0x0abe,0x0acf,0x0abd,0x0aae,0x0aad,0x0ab4,0x0aad,0x0abc,0x0a87,0x0a88,0x0a75,0x0a94,0x0a8c,0x0a85,0x0a5a,0x0a72,0x0a5a,0x0a47,0x0a54,0x0a75,0x0a54,0x0a56,0x0a4c,0x0a45,0x0a26,0x0a40,0x0a47,0x0a39,0x0a36,0x0a3e,0x0a2e,0x0a2d,0x0a1e,0x0a3a,0x0a32,0x0a28,0x0a17,0x0a40,0x0a24,0x0a18,0x0a00,0x09fa,0x09fd,0x0a11,0x0a1e,0x0a2a,0x0a00,0x09e8,0x09e9,0x09f7,0x09ea,0x0a06,0x09ef,0x0a0d,0x09f0,0x09fd,0x09b4,0x09c8,0x09d6,0x09cf,0x09d2,0x09fa,0x09da,0x09e2,0x09b6,0x09bd,0x09bf,0x09de,0x09e7,0x09ef,0x09c1,0x09d9,0x09bf,0x09b0,0x09cc,0x09eb,0x09aa,0x09bb,0x099e,0x09b7,0x099d,0x09ba,0x09cd,0x09d3,0x09ad,0x09a7,0x0986,0x0987,0x097c,0x09a9,0x09a6,0x09b8,0x0988,0x0992,0x0973,0x0996,0x099e,0x09a9,0x09a9,0x09ac,0x097a,0x097b,0x0983,0x09af,0x098f,0x0998,0x0987,0x098a,0x0972,0x0972,0x0985,0x09a3,0x0993,0x0996,0x0971,0x0976,0x098d,0x0996,0x097b,0x0995,0x0988,0x0982,0x095c,0x0980,0x097c,0x096e,0x098b,0x09a7,0x097d,0x0970,0x0966,0x095c,0x0956,0x096a,0x097b,0x0991,0x0977,0x097c,0x0968,0x096e,0x0969,0x098f,0x097b,0x0990,0x0964,0x096a,0x0962,0x096b,0x0972,0x098d,0x0960,0x096f,0x095b,0x0960,0x0944,0x095d,0x0961,0x097a,0x0964,0x095c,0x0950,0x0950,0x093b,0x0955,0x094c,0x0964,0x0958,0x095c,0x0937,0x0946,0x093e,0x0956,0x095f,0x095e,0x0941,0x094c,0x0937,0x093b,0x091e,0x0941,0x0942,0x0958,0x093e,0x094c,0x0933,0x0948,0x094c,0x0967,0x0941,0x0953,0x0936,0x093e,0x0915,0x092b,0x0949,0x095b,0x0951,0x096d,0x0955,0x095f,0x093a,0x094d,0x093f,0x0949,0x0949,0x0963,0x0934,0x0948,0x0942,0x095e,0x0947,0x0964,0x0944,0x094b,0x0930,0x0939,0x092f,0x093c,0x0958,0x0971,0x0963,0x0963,0x0934,0x0948,0x0932,0x095f,0x094d,0x0966,0x094a,0x0944,0x0937,0x0963,0x0943,0x093f,0x0935,0x094a,0x093b,0x0958,0x094f,0x0942,0x0934,0x0957,0x0952,0x0960,0x093f,0x0950,0x0935,0x092b,0x0936,0x0954,0x0947,0x0957,0x0934,0x0925,0x0931,0x094e,0x0948,0x0954,0x093f,0x094e,0x093a,0x0940,0x091a,0x0933,0x0937,0x0946,0x0939,0x0943,0x0933,0x092c,0x08fc,0x091a,0x091e,0x0936,0x0923,0x0927,0x0921,0x0926,0x0909,0x0913,0x090f,0x092f,0x092c,0x0941,0x090f,0x090b,0x08ff,0x0916,0x0922,0x092c,0x0938,0x093a,0x0910,0x0919,0x0925,0x093a,0x0918,0x092d,0x092c,0x092c,0x091b,0x092d,0x0938,0x094d,0x093d,0x093c,0x091a,0x0923,0x091d,0x0940,0x0940,0x0946,0x094f,0x0960,0x0932,0x0936,0x091a,0x090f,0x091a,0x0944,0x0937,0x0945,0x0921,0x0939,0x0919,0x091b,0x091b,0x0937,0x093b,0x093e,0x0917,0x090c,0x0914,0x093c,0x0921,0x0931,0x0919,0x090f,0x0910,0x0920,0x0934,0x0941,0x0938,0x0938,0x0905,0x090b,0x0917,0x0946,0x0936,0x0947,0x0930,0x0933,0x0918,0x092d,0x0922,0x091c,0x0934,0x0944,0x0936,0x0949,0x092d,0x0928,0x0917,0x0940,0x0946,0x094c,0x0915,0x093e,0x0932,0x092e,0x0929,0x094b,0x0941,0x094a,0x0914,0x091b,0x0922,0x0932,0x0924,0x093d,0x093b,0x0943,0x091d,0x092e,0x0932,0x093d,0x094d,0x0950,0x0928,0x091b,0x0919,0x0933,0x0925,0x0936,0x092d,0x0939,0x0912,0x0919,0x0910,0x0926,0x091b,0x093b,0x0915,0x08ed,0x08f9,0x0921,0x090d,0x0914,0x090d,0x092e,0x0903,0x08fb,0x08ed,0x0907,0x090a,0x091c,0x0920,0x0927,0x091a,0x0925,0x08ff,0x0909,0x0906,0x091d,0x0923,0x093d,0x08f5,0x0904,0x0908,0x0907,0x0906,0x092e,0x091f,0x0930,0x0906,0x0922,0x08fd,0x090e,0x0912,0x0940,0x091f,0x0924,0x0924,0x0943,0x090c,0x0927,0x0914,0x0933,0x0910,0x0929,0x091d,0x0926,0x090d,0x0920,0x0922,0x0948,0x0906,0x090e,0x08e0,0x0903,0x08e4,0x0901,0x0905,0x0930,0x0902,0x091c,0x08f5,0x0906,0x08ef,0x092d,0x090b,0x0919,0x08f7,0x0913,0x0908,0x0916,0x0902,0x0922,0x0920,0x091f,0x08f7,0x090d,0x08d3,0x090d,0x0907,0x0932,0x0916,0x0927,0x0901,0x0911,0x08f9,0x090f,0x091c,0x092e,0x08fc,0x091b,0x0912,0x0925,0x08fc,0x091b,0x0922,0x091d,0x08e2,0x08f2,0x0906,0x0904,0x0905,0x0927,0x091d,0x090d,0x08fb,0x092c,0x0909,0x0913,0x0901,0x0903,0x08db,0x08f5,0x090d,0x0927,0x0904,0x0909,0x0920,0x091d,0x08ff,0x091a,0x0908,0x090e,0x0903,0x092a,0x0910,0x0917,0x08f9,0x0904,0x091b,0x0930,0x0924,0x0936,0x091e,0x090d,0x08ff,0x0918,0x0912,0x0920,0x092b,0x0947,0x0906,0x0923,0x0915,0x0924,0x0923,0x093c,0x0911,0x0900,0x08fe,0x0924,0x0926,0x0928,0x091e,0x092d,0x090a,0x0908,0x0928,0x094c,0x0932,0x093d,0x0923,0x092e,0x0902,0x0919,0x091b,0x0925,0x0927,0x092e,0x0936,0x094e,0x0901,0x0900,0x091a,0x0930,0x0917,0x0935,0x0947,0x094d,0x091f,0x0933,0x0922,0x0932,0x091c,0x0934,0x0937,0x0937,0x0905,0x090e,0x0906,0x0928,0x092a,0x0934,0x0916,0x091b,0x08f8,0x0904,0x091f,0x0938,0x0923,0x092a,0x0917,0x091a,0x0900,0x091c,0x0906,0x091f,0x092a,0x093a,0x091c,0x092b,0x090a,0x0912,0x0906,0x092d,0x0932,0x0932,0x0908,0x0907,0x08fe,0x090e,0x090c,0x092b,0x0944,0x093c,0x08fb,0x0913,0x0904,0x0911,0x0901,0x091d,0x091d,0x091b,0x0903,0x091e,0x0914,0x08fc,0x08fe,0x092b,0x0911,0x092d,0x0926,0x091b,0x0919,0x092e,0x093d,0x0941,0x0917,0x0929,0x0910,0x0901,0x0909,0x092c,0x0923,0x092e,0x0912,0x0915,0x0904,0x0916,0x0921,0x0931,0x0928,0x0931,0x0910,0x0919,0x08f9,0x091f,0x0927,0x0940,0x0917,0x0916,0x090c,0x0922,0x091d,0x091f,0x091b,0x0941,0x0918,0x092a,0x0904,0x091c,0x0918,0x0938,0x090b,0x0918,0x090e,0x0926,0x090e,0x090c,0x090f,0x092e,0x0916,0x0922,0x0907,0x0916,0x08f6,0x090c,0x090b,0x0935,0x0919,0x091a,0x08fb,0x0902,0x0908,0x0921,0x090d,0x0922,0x08f0,0x0903,0x08ef,0x08f7,0x0905,0x0935,0x0915,0x0924,0x08fe,0x0911,0x08e6,0x08fe,0x0903,0x0928,0x0914,0x0912,0x08fe,0x090e,0x08f6,0x090e,0x0918,0x091b,0x090d,0x091c,0x090d,0x0919,0x08dc,0x08fd,0x08e6,0x090f,0x08fc,0x091c,0x08f9,0x090e,0x08eb,0x08fe,0x0918,0x092b,0x092b,0x0932,0x08ee,0x08ff,0x0903,0x092b,0x0911,0x0929,0x091b,0x0915,0x08e1,0x0905,0x0913,0x0923,0x0918,0x093f,0x092f,0x093c,0x0918,0x0920,0x0905,0x0917,0x0913,0x0935,0x0922,0x092e,0x0916,0x0917,0x090d,0x092b,0x091a,0x0930,0x0907,0x08fd,0x0908,0x0927,0x0920,0x092e,0x0921,0x0931,0x090f,0x091d,0x091a,0x0939,0x0932,0x094a,0x091e,0x091f,0x091e,0x0936,0x0928,0x0941,0x0945,0x094f,0x091e,0x092f,0x0924,0x0937,0x0940,0x0955,0x0932,0x0918,0x091d,0x092b,0x0942,0x094a,0x0933,0x094f,0x092c,0x0927,0x08fd,0x0926,0x092c,0x0941,0x092f,0x092d,0x0920,0x0916,0x091f,0x0931,0x0903,0x0925,0x092b,0x0939,0x0908,0x090c,0x090a,0x0929,0x0910,0x0925,0x0928,0x0922,0x08f0,0x0914,0x0923,0x0929,0x0907,0x0918,0x0904,0x091e,0x0929,0x0940,0x0915,0x0902,0x0904,0x0912,0x0902,0x0914,0x0926,0x0939,0x092c,0x092d,0x0909,0x0915,0x0908,0x08fa,0x0907,0x0934,0x0929,0x091c,0x08f9,0x0904,0x0903,0x0924,0x0925,0x092a,0x0920,0x0925,0x0922,0x092c,0x091c,0x093d,0x0932,0x091f,0x090c,0x0913,0x0911,0x0919,0x0924,0x092b,0x08f8,0x0906,0x0919,0x092a,0x0915,0x0932,0x0927,0x091b,0x08e6,0x08f1,0x0904,0x090e,0x0921,0x092d,0x0920,0x0910,0x0928,0x0935,0x092c,0x0954,0x0932,0x0938,0x08fe,0x08ff,0x0901,0x0912,0x093a,0x0941,0x0929,0x093b,0x0915,0x091a,0x092a,0x094a,0x0934,0x0911,0x090a,0x092f,0x0919,0x0925,0x092a,0x096c,0x0942,0x0928,0x0912,0x092d,0x0921,0x0931,0x0936,0x0942,0x0935,0x093d,0x0908,0x0916,0x08ec,0x090f,0x0917,0x0936,0x0907,0x0917,0x0912,0x0921,0x0905,0x091a,0x0935,0x096d,0x0934,0x0930,0x0901,0x090a,0x08fe,0x092f,0x090e,0x091e,0x091f,0x0914,0x08fb,0x0916,0x0924,0x091e,0x08fa,0x091b,0x0919,0x091f,0x0900,0x0930,0x090c,0x090f,0x091b,0x091f,0x08fa,0x0942,0x08f7,0x08fa,0x091a,0x0939,0x090c,0x0925,0x0900]

@testset "regression" begin
  @test 7.338590391908976e-5==Pope.estimate_rise_time(pulserecord, searchrange, peakval,ptm,frametime)
  #previously failed with BoundsError
end
